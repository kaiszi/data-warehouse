{"paragraphs":[{"title":"Analiza 1 - Liczba przestępstw danego typu w zależności od rejonu","text":"%sql\n-- select fc.locationId, dc.crimeType, ds.source \n-- from f_crime fc \n-- join d_source ds on fc.sourceId = ds.id\n-- join d_crime_type dc on fc.crimeTypeId = dc.id\n-- where ds.id in (0, 1) -- Wybór regionu\n\nselect count(fc.crimeId), dc.crimeType, ds.source \nfrom f_crime fc \njoin d_source ds on fc.sourceId = ds.id\njoin d_crime_type dc on fc.crimeTypeId = dc.id\n\ngroup by dc.crimeType, ds.source","user":"anonymous","dateUpdated":"2020-01-22T00:35:46+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"count(crimeId)":"string","crimeType":"string","source":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default","stacked":true},"stackedAreaChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"crimeType","index":1,"aggr":"sum"}],"groups":[{"name":"source","index":2,"aggr":"sum"}],"values":[{"name":"count(crimeId)","index":0,"aggr":"sum"}]},"helium":{}}},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"count(crimeId)\tcrimeType\tsource\n863\tBurglary\tLondon\n1137\tVehicle crime\tLondon\n10\tViolence and sexual offences\tMetropolitan_area\n6\tOther crime\tMetropolitan_area\n10\tOther theft\tMetropolitan_area\n8806\tShoplifting\tLondon\n1352\tCriminal damage and arson\tLondon\n305\tPossession of weapons\tLondon\n3\tPossession of weapons\tMetropolitan_area\n3149\tBicycle theft\tLondon\n6\tRobbery\tMetropolitan_area\n905\tPublic order\tLondon\n3683\tDrugs\tLondon\n411\tRobbery\tLondon\n2339\tViolence and sexual offences\tLondon\n2129\tTheft from the person\tLondon\n16\tDrugs\tMetropolitan_area\n5\tBurglary\tMetropolitan_area\n612\tOther crime\tLondon\n13363\tOther theft\tLondon\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://cluster-project-2-m.europe-west6-a.c.my-project-1500721655498.internal:4040/jobs/job?id=48","http://cluster-project-2-m.europe-west6-a.c.my-project-1500721655498.internal:4040/jobs/job?id=49","http://cluster-project-2-m.europe-west6-a.c.my-project-1500721655498.internal:4040/jobs/job?id=50","http://cluster-project-2-m.europe-west6-a.c.my-project-1500721655498.internal:4040/jobs/job?id=51","http://cluster-project-2-m.europe-west6-a.c.my-project-1500721655498.internal:4040/jobs/job?id=52","http://cluster-project-2-m.europe-west6-a.c.my-project-1500721655498.internal:4040/jobs/job?id=53","http://cluster-project-2-m.europe-west6-a.c.my-project-1500721655498.internal:4040/jobs/job?id=54"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1579650907105_-1306017702","id":"20200121-235507_1612969032","dateCreated":"2020-01-21T23:55:07+0000","dateStarted":"2020-01-22T00:16:59+0000","dateFinished":"2020-01-22T00:17:03+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:20907"},{"text":"%sql\nselect count(fc.crimeId), dc.crimeType, o.outcome \nfrom f_crime fc \njoin d_crime_outcome_type o on fc.outcomeId = o.id\njoin d_crime_type dc on fc.crimeTypeId = dc.id\ngroup by dc.crimeType, o.outcome","user":"anonymous","dateUpdated":"2020-01-22T00:34:16+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":196,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"count(crimeId)":"string","crimeType":"string","outcome":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default","stacked":false}},"commonSetting":{},"keys":[{"name":"crimeType","index":1,"aggr":"sum"}],"groups":[{"name":"outcome","index":2,"aggr":"sum"}],"values":[{"name":"count(crimeId)","index":0,"aggr":"sum"}]},"helium":{}}},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"count(crimeId)\tcrimeType\toutcome\n137\tRobbery\tSuspect charged\n611\tViolence and sexual offences\tUnable to prosecute suspect\n137\tTheft from the person\tSuspect charged\n274\tCriminal damage and arson\tOffender fined\n433\tShoplifting\tOffender given suspended prison sentence\n685\tShoplifting\tOffender given a caution\n137\tVehicle crime\tOffender sent to prison\n137\tOther theft\tOffender fined\n594\tBurglary\tInvestigation complete; no suspect identified\n2944\tBicycle theft\tInvestigation complete; no suspect identified\n411\tViolence and sexual offences\tOffender given a caution\n41\tOther theft\tOffender given a caution\n137\tCriminal damage and arson\tOffender given penalty notice\n137\tBurglary\tOffender sent to prison\n1403\tDrugs\tOffender given a drugs possession warning\n137\tBurglary\tSuspect charged\n137\tDrugs\tOffender ordered to pay compensation\n337\tOther theft\tUnable to prosecute suspect\n14\tOther crime\tOffender sent to prison\n12574\tOther theft\tInvestigation complete; no suspect identified\n621\tViolence and sexual offences\tInvestigation complete; no suspect identified\n41\tPossession of weapons\tOffender given suspended prison sentence\n137\tShoplifting\tOffender otherwise dealt with\n313\tCriminal damage and arson\tSuspect charged\n22\tPublic order\tFormal action is not in the public interest\n149\tPublic order\tSuspect charged\n274\tDrugs\tOffender given community sentence\n1855\tTheft from the person\tInvestigation complete; no suspect identified\n41\tBicycle theft\tOffender fined\n3877\tShoplifting\tSuspect charged\n411\tPublic order\tInvestigation complete; no suspect identified\n5\tPublic order\tCourt case unable to proceed\n4\tPossession of weapons\tFormal action is not in the public interest\n17\tCriminal damage and arson\tOffender sent to prison\n41\tPossession of weapons\tOffender given community sentence\n22\tDrugs\tOffender given penalty notice\n137\tShoplifting\tOffender given conditional discharge\n548\tShoplifting\tOffender fined\n137\tPublic order\tOffender given penalty notice\n330\tOther crime\tSuspect charged\n1000\tVehicle crime\tInvestigation complete; no suspect identified\n137\tRobbery\tOffender sent to prison\n137\tOther crime\tDefendant sent to Crown Court\n41\tBicycle theft\tOffender given community sentence\n411\tCriminal damage and arson\tInvestigation complete; no suspect identified\n452\tShoplifting\tOffender given penalty notice\n137\tCriminal damage and arson\tOffender given a caution\n1167\tDrugs\tSuspect charged\n147\tOther theft\tSuspect charged\n123\tBicycle theft\tSuspect charged\n22\tViolence and sexual offences\tOffender fined\n337\tShoplifting\tLocal resolution\n41\tViolence and sexual offences\tFormal action is not in the public interest\n137\tRobbery\tUnable to prosecute suspect\n518\tDrugs\tOffender given a caution\n137\tTheft from the person\tOffender given community sentence\n22\tCriminal damage and arson\tOffender given conditional discharge\n6\tRobbery\tInvestigation complete; no suspect identified\n178\tDrugs\tOffender fined\n63\tViolence and sexual offences\tOffender given suspended prison sentence\n41\tCriminal damage and arson\tLocal resolution\n222\tPossession of weapons\tSuspect charged\n137\tOther theft\tCourt case unable to proceed\n767\tShoplifting\tInvestigation complete; no suspect identified\n959\tShoplifting\tOffender given community sentence\n137\tOther crime\tUnable to prosecute suspect\n580\tViolence and sexual offences\tSuspect charged\n181\tPublic order\tUnable to prosecute suspect\n452\tShoplifting\tOffender sent to prison\n22\tShoplifting\tCourt case unable to proceed\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://cluster-project-2-m.europe-west6-a.c.my-project-1500721655498.internal:4040/jobs/job?id=58","http://cluster-project-2-m.europe-west6-a.c.my-project-1500721655498.internal:4040/jobs/job?id=59","http://cluster-project-2-m.europe-west6-a.c.my-project-1500721655498.internal:4040/jobs/job?id=60","http://cluster-project-2-m.europe-west6-a.c.my-project-1500721655498.internal:4040/jobs/job?id=61","http://cluster-project-2-m.europe-west6-a.c.my-project-1500721655498.internal:4040/jobs/job?id=62","http://cluster-project-2-m.europe-west6-a.c.my-project-1500721655498.internal:4040/jobs/job?id=63","http://cluster-project-2-m.europe-west6-a.c.my-project-1500721655498.internal:4040/jobs/job?id=64"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1579651649455_-147944855","id":"20200122-000729_995876675","dateCreated":"2020-01-22T00:07:29+0000","dateStarted":"2020-01-22T00:24:29+0000","dateFinished":"2020-01-22T00:24:33+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:20908","title":"Analiza 2 - Jak najczęściej kończą się dane wykroczenia?"},{"text":"%sql\nselect count(fc.crimeId), dl.lsoaCode, dc.crimeType\nfrom f_crime fc \njoin d_location dl on fc.locationId = dl.id\njoin d_crime_type dc on fc.crimeTypeId = dc.id\ngroup by dc.crimeType, dl.lsoaCode\n","user":"anonymous","dateUpdated":"2020-01-22T00:43:41+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":682,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"count(crimeId)":"string","locationType":"string","crimeType":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default","stacked":true}},"commonSetting":{},"keys":[{"name":"lsoaCode","index":1,"aggr":"sum"}],"groups":[{"name":"crimeType","index":2,"aggr":"sum"}],"values":[{"name":"count(crimeId)","index":0,"aggr":"sum"}]},"helium":{}}},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"count(crimeId)\tlsoaCode\tcrimeType\n8494\tE01032739\tShoplifting\n164\tE01032740\tPossession of weapons\n42\tE01000002\tOther crime\n10\tE01000081\tViolence and sexual offences\n44\tE01000005\tTheft from the person\n24\tE01000001\tBicycle theft\n16\tE01000013\tDrugs\n66\tE01000005\tShoplifting\n2\tE01004293\tBicycle theft\n66\tE01000005\tPublic order\n6\tE01004293\tDrugs\n10\tE01000027\tOther theft\n411\tE01032739\tRobbery\n4\tE01000003\tDrugs\n5\tE01033490\tPublic order\n1\tE01002706\tDrugs\n41\tE01032740\tVehicle crime\n1918\tE01032739\tTheft from the person\n48\tE01000001\tOther theft\n24\tE01000001\tTheft from the person\n287\tE01032740\tViolence and sexual offences\n2\tE01004735\tOther theft\n41\tE01032740\tCriminal damage and arson\n246\tE01032740\tShoplifting\n943\tE01032740\tOther theft\n112\tE01000002\tOther theft\n1096\tE01032739\tVehicle crime\n10\tE01033490\tCriminal damage and arson\n12\tE01004307\tDrugs\n123\tE01032740\tTheft from the person\n5\tE01000022\tBurglary\n6\tE01000086\tOther crime\n24\tE01000001\tDrugs\n6\tE01000086\tRobbery\n3\tE01000018\tPossession of weapons\n615\tE01032740\tBicycle theft\n1233\tE01032739\tCriminal damage and arson\n41\tE01032740\tBurglary\n137\tE01032739\tPossession of weapons\n198\tE01000005\tDrugs\n4\tE01004735\tTheft from the person\n24\tE01000001\tCriminal damage and arson\n287\tE01032740\tDrugs\n22\tE01000005\tOther crime\n12\tE01000001\tPublic order\n24\tE01000001\tViolence and sexual offences\n110\tE01000005\tViolence and sexual offences\n822\tE01032739\tPublic order\n4\tE01000003\tOther theft\n198\tE01000005\tOther theft\n822\tE01032739\tBurglary\n14\tE01000002\tTheft from the person\n2\tE01004293\tTheft from the person\n12056\tE01032739\tOther theft\n42\tE01000002\tBicycle theft\n4\tE01004307\tPossession of weapons\n1918\tE01032739\tViolence and sexual offences\n548\tE01032739\tOther crime\n2466\tE01032739\tBicycle theft\n44\tE01000005\tCriminal damage and arson\n3151\tE01032739\tDrugs\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://cluster-project-2-m.europe-west6-a.c.my-project-1500721655498.internal:4040/jobs/job?id=80","http://cluster-project-2-m.europe-west6-a.c.my-project-1500721655498.internal:4040/jobs/job?id=81","http://cluster-project-2-m.europe-west6-a.c.my-project-1500721655498.internal:4040/jobs/job?id=82","http://cluster-project-2-m.europe-west6-a.c.my-project-1500721655498.internal:4040/jobs/job?id=83","http://cluster-project-2-m.europe-west6-a.c.my-project-1500721655498.internal:4040/jobs/job?id=84","http://cluster-project-2-m.europe-west6-a.c.my-project-1500721655498.internal:4040/jobs/job?id=85","http://cluster-project-2-m.europe-west6-a.c.my-project-1500721655498.internal:4040/jobs/job?id=86"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1579652060932_-754737429","id":"20200122-001420_1081611146","dateCreated":"2020-01-22T00:14:20+0000","dateStarted":"2020-01-22T00:42:10+0000","dateFinished":"2020-01-22T00:42:14+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:20909","title":"Analiza 3 - Rejony o najwyższej przestępczości ( z podziałem na poszczególne rodzaje przestępstw)"},{"text":"%sql\n","user":"anonymous","dateUpdated":"2020-01-22T00:35:06+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579653306652_-420253522","id":"20200122-003506_2097658126","dateCreated":"2020-01-22T00:35:06+0000","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:23545"}],"name":"Analysis","id":"2EZ4QFZ1S","noteParams":{},"noteForms":{},"angularObjects":{"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}